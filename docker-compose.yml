services:
  booktoaudioapi:
    build:
      context: .
      dockerfile: docker/api.Dockerfile
      # cache_from:
      #   - alikberova/booktoaudio.api:latest
      args:
        API_NAME: BookToAudio.Api
    image: alikberova/booktoaudio.api${IMAGE_TAG_SUFFIX}:latest
    env_file: .env
    container_name: booktoaudio_api
    ports:
      - "7057:7057"

  booktoaudioweb:
    build:
      context: BookToAudio.Web
      dockerfile: ../docker/web.Dockerfile
      # cache_from:
      #   - alikberova/booktoaudio.web:latest
    image: alikberova/booktoaudio.web${IMAGE_TAG_SUFFIX}:latest
    environment:
      ENVIRONMENT: ${ENVIRONMENT}
    container_name: booktoaudio_web
    ports:
      - "${ANGULAR_PORT}:80" # ANGULAR_PORT should be the same as in selenium tests