<form class="tts-form content" (ngSubmit)="onSubmit()">
  <mat-form-field class="form-element">
    <mat-label>Select voice</mat-label>
    <mat-select [(ngModel)]="textToSpeech.voice" name="voice">
      <mat-option *ngFor="let voice of voices" [value]="voice">
        {{ voice }}
        <mat-icon [ngClass]="{'disabled': currentlyLoadingAudio}" class="play-icon" *ngIf="!isPlaying && currentlyPlayingVoice !== voice" (click)="playVoiceSample($event, voice.toString(), textToSpeech.speed!)" [attr.aria-label]="'Play voice sample for ' + voice">play_circle</mat-icon>
        <mat-icon class="play-icon pause" *ngIf="!isPlaying && currentlyPlayingVoice === voice && isPaused" (click)="playVoiceSample($event, voice.toString(), textToSpeech.speed!)" [attr.aria-label]="'Pause voice sample'">play_circle</mat-icon>
        <mat-icon class="play-icon" *ngIf="!currentlyLoadingAudio && currentlyPlayingVoice === voice && !isPaused" [attr.aria-label]="'Pause voice sample'" (click)="pauseAudio($event)">pause</mat-icon>
        <mat-icon class="play-icon" *ngIf="currentlyLoadingAudio && currentlyPlayingVoice === voice" [attr.aria-label]="'Voice sample is loading'" (click)="stopPropagation($event)">downloading</mat-icon>
      </mat-option>
    </mat-select>
  </mat-form-field>

  <div class="file-upload form-element">
    <button type="button" mat-raised-button color="primary" (click)="fileInput.click()"
    [ngClass]="{'file-selected': textToSpeech.file}">Choose File</button>
    <input hidden #fileInput type="file" (change)="onFileSelected($event)" accept=".pdf,.txt"
           aria-label="Upload File"/>
    <div>
      <span *ngIf="textToSpeech.file">{{ textToSpeech.file.name }}</span>
      <button mat-button *ngIf="textToSpeech.file" (click)="clearFileSelection()" color="warn"
              aria-label="Clear selected file">
        <mat-icon>clear</mat-icon>
      </button>
    </div>
  </div>

  <mat-form-field class="form-element">
    <mat-label>Setup speed</mat-label>
    <input matInput type="number" min="0.5" max="4" step="0.1" [(ngModel)]="textToSpeech.speed" name="speed" />
  </mat-form-field>

  <div class="progress-bar-container">
    <mat-progress-bar *ngIf="isLoading" mode="indeterminate"></mat-progress-bar>
  </div>

  <button mat-raised-button color="primary" class="form-element submit-btn" [disabled]="!textToSpeech.file"
    [matTooltip]="textToSpeech.file || isSpeechReady ? '' : 'You need to select file first'">Submit
  </button>

  <a mat-raised-button color="accent" class="form-element" [href]="audioDownloadUrl" download
     [disabled]="!isSpeechReady">
    Download
  </a>

</form>
